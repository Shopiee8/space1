import{b as B,j as L,k as M,l as E,r as b,m as D,Q as F,G as v,p as H}from"./entry.3e07ed2f.js";const k=d=>d&&d[0].toUpperCase()+d.slice(1)||"",C=[{id:"dipperOrDiver",a:{q:"dipping a toe",tags:["strategy","data","growth-marketing","tech-engineering","marketplaces"]},b:{q:"diving in",tags:["creativity","social","digital-transformation","ar-vr","experience","automation","ai-ml","metaverse","web3","media"]}},{id:"urlOrIrl",a:{q:"url",tags:["ar-vr","experience","ai-ml","metaverse","ai-ml","web3"]},b:{q:"irl",tags:["strategy","creativity","branding","social","advertising","commerce","loyalty","tech-engineering","marketplaces"]}},{id:"fameOrFortune",a:{q:"fame",tags:["social","advertising","ar-vr","experience","loyalty","tech-engineering","marketplaces"]},b:{q:"fortune",tags:["strategy","commerce","automation","data","growth-marketing","tech-engineering","marketplaces"]}},{id:"tortoiseOrHare",a:{q:"hare",tags:["strategy","digital-transformation","automation","data","growth-marketing","loyalty","ai-ml","media"]},b:{q:"tortoise",tags:["creativity","branding","social","advertising","tech-engineering"]}},{id:"mathematicianOrArtist",a:{q:"mathematician",tags:["strategy","digital-transformation","commerce","automation","data","growth-marketing","ai-ml","metaverse","media","marketplaces"]},b:{q:"artist",tags:["creativity","branding","social","advertising","ar-vr","web3"]}}],e=B();function G(){const d=window.location.hostname==="localhost"?"http://localhost:3001/api":`https://${window.location.host}/api`,T=L(),{locale:A}=M(),l=E([...F]),m=b(0),O=D(()=>l.length),h=b(0),S=D(()=>l.filter(a=>a.type==="question"||a.type==="thisOrThat"||a.type==="wheel").length),q=D(()=>h.value/S.value*100),u=b(!1),I=async({answer:a}={})=>{if(a&&(l[m.value].store&&(e[l[m.value].store]=a,v.emit("webgl_experience_question_answered",l[m.value].store)),h.value++,a==="yes"&&(l.splice(m.value+1,1),e.company==="DEPT\xAE"?l.splice(m.value+1,0,{id:O.value+h.value,type:"chat",content:{title:"DEPT\xAE is a global digital agency that pioneers technology and marketing to help brands stay ahead.",size:"s",cta:!0}}):await $([{role:"system",content:"You are a futuristic AI entity. Answer Briefly but personal, do not ask questions."},{role:"user",content:`Begin by complementing me for my position and very briefly explain the business ${e.company} in max 50 words.`}])),l[m.value].content.prompt&&(l[m.value].store==="company"&&await P(),l[m.value].store==="company"&&e.company==="DEPT\xAE"?l.splice(m.value+1,0,{id:O.value+h.value,type:"chat",content:{title:"DEPT\xAE is a global digital agency that pioneers technology and marketing to help brands stay ahead.",size:"s",cta:!0}}):await $(l[m.value].content.prompt,a)),l[m.value].store==="email"&&(await R(),e.company||l.splice(m.value+1,1))),h.value===S.value&&(e.seed=H(),N()),m.value<O.value-1)m.value++;else{const i=Object.keys({"en-GB":"United Kingdom","en-US":"United States","en-DE":"Germany"}).some(s=>window.location.href.toLowerCase().includes(s.toLowerCase()))?`/${A.value}`:"";T.push({path:`${i}/results`})}},$=async(a,r)=>{var i,s,n,p;u.value=!0,v.emit("gpt3_loading_start");try{const o=a.map(c=>({role:c.role,content:c.content.replace("{answer}",r).replace("{user}",e.firstname).replace("{company}",e.company).replace("{archetype}",e.archetype)})),g=await(await fetch(`${d}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:o})})).json();(i=g.data)!=null&&i.choices&&l.splice(m.value+1,0,{id:O.value+h.value,type:"chat",content:{title:(p=(n=(s=g.data)==null?void 0:s.choices[0])==null?void 0:n.message)==null?void 0:p.content,size:"s",cta:!0}}),u.value=!1,v.emit("gpt3_loading_complete")}catch(o){console.error(o),u.value=!1,v.emit("gpt3_loading_complete")}},_=async()=>{const a=C.map(c=>{const y=e[c.id];if(!y)return null;const f=C.find(w=>w.id===c.id);return f.a.q===y?f.a.tags:f.b.tags}).flat().filter(c=>c!==null),r={};a.forEach(c=>{r[c]?r[c]++:r[c]=1});const i=Object.keys(r).sort((c,y)=>r[y]-r[c]),s={strategy:"thoughtful",creativity:"grounded",branding:"patient",social:"patient","digital-transformation":"intrepid","ar-vr":"pioneering",commerce:"grounded",experience:"pioneering",automation:"intrepid",data:"thoughtful","growth-marketing":"pioneering",loyalty:"grounded","tech-engineering":"spontaneous","ai-ml":"intrepid",metaverse:"pioneering",web3:"intrepid",media:"spontaneous",marketplaces:"grounded"},n={strategy:"magnate",creativity:"analyst",branding:"icon",advertising:"luminary",social:"luminary","digital-transformation":"magnate","ar-vr":"virtuoso",commerce:"magnate",experience:"icon",automation:"pragmatist",data:"magnate","growth-marketing":"analyst",loyalty:"luminary","tech-engineering":"analyst","ai-ml":"magnate",metaverse:"icon",web3:"luminary",media:"magnate",marketplaces:"magnate"},p=[{id:"dipperOrDiver",a:e.dipperOrDiver==="dipping a toe"?"dipping a toe":"diving in",b:e.dipperOrDiver!=="dipping a toe"?"dipping a toe":"diving in"},{id:"espressoOrColdbrew",a:e.espressoOrColdbrew==="espresso"?"espresso":"coldbrew",b:e.espressoOrColdbrew!=="espresso"?"espresso":"coldbrew"},{id:"urlOrIrl",a:e.urlOrIrl==="url"?"url":"irl",b:e.urlOrIrl!=="url"?"url":"irl"},{id:"fameOrFortune",a:e.fameOrFortune==="fame"?"fame":"fortune",b:e.fameOrFortune!=="fame"?"fame":"fortune"},{id:"cloudOrDetails",a:e.cloudOrDetails==="cloud"?"cloud":"details",b:e.cloudOrDetails!=="cloud"?"cloud":"details"},{id:"tortoiseOrHare",a:e.tortoiseOrHare==="tortoise"?"tortoise":"hare",b:e.tortoiseOrHare!=="tortoise"?"tortoise":"hare"},{id:"mathematicianOrArtist",a:e.mathematicianOrArtist==="mathematician"?"mathematician":"artist",b:e.mathematicianOrArtist!=="mathematician"?"mathematician":"artist"}],o=[];for(;o.length<2;){const c=p[Math.floor(Math.random()*p.length)];o.includes(c)||o.push(c)}const t=[{id:"dipperOrDiver",value:e.dipperOrDiver==="dipping a toe"?"dipperOrDiverA":"dipperOrDiverB"},{id:"urlOrIrl",value:e.urlOrIrl==="url"?"urlOrIrlA":"urlOrIrlB"},{id:"tortoiseOrHare",value:e.tortoiseOrHare==="tortoise"?"tortoiseOrHareA":"tortoiseOrHareB"}],g=[{id:"fameOrFortune",value:e.fameOrFortune==="fame"?"fameOrFortuneA":"fameOrFortuneB"},{id:"cloudOrDetails",value:e.cloudOrDetails==="cloud"?"cloudOrDetailsA":"cloudOrDetailsB"},{id:"mathematicianOrArtist",value:e.mathematicianOrArtist==="mathematician"?"mathematicianOrArtistA":"mathematicianOrArtistB"}];return{title:{adjective:s[i[0]]||s[Math.floor(Math.random()*s.length)],noun:n[i[1]]||n[Math.floor(Math.random()*n.length)]},tags:i,thisThatA:o[0].a,thisThatB:o[0].b,thisThatC:o[1].a,thisThatD:o[1].b,ttPoolA:t[Math.floor(Math.random()*t.length)],ttPoolB:g[Math.floor(Math.random()*g.length)]}},P=async()=>{var a,r,i,s;u.value=!0;try{const n=[{role:"user",content:`Extract the company name from this answer: "${e.company}". Don't make sentences, just the company name. without the final punctuation. If the company name is Dept, answer "DEPT\xAE"`}],o=await(await fetch(`${d}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:n})})).json();if((a=o.data)!=null&&a.choices[0]){const t=(s=(i=(r=o.data)==null?void 0:r.choices[0])==null?void 0:i.message)==null?void 0:s.content;t&&t!=="null"&&t!=="gmail"&&t!=="yahoo"&&t!=="hotmail"&&t!=="outlook"&&(t.toLowerCase()==="dept"||t.toLowerCase()==="dept-agency"||t.toLowerCase()==="dept agency"?e.company="DEPT\xAE":e.company=k(t))}u.value=!1}catch(n){console.error(n),u.value=!1}},R=async()=>{var a,r,i,s;u.value=!0;try{const n=[{role:"user",content:`Considering my answers to the questions "What's your firstname?" and "What's your email address?" the followings: "${e.firstname}" and "${e.email}", provide me my firstname and my company name thanks to the email address in a JSON format with the following keys: "firstname", "company". If you cannot guess, provide a null value for the key.`}],o=await(await fetch(`${d}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:n})})).json();if((a=o.data)!=null&&a.choices[0]){const t=JSON.parse((s=(i=(r=o.data)==null?void 0:r.choices[0])==null?void 0:i.message)==null?void 0:s.content);t.company&&t.company!=="null"&&t.company!=="gmail"&&t.company!=="yahoo"&&t.company!=="hotmail"&&t.company!=="outlook"&&(t.company.toLowerCase()==="dept"||t.company.toLowerCase()==="dept-agency"||t.company.toLowerCase()==="dept agency"?e.company="DEPT\xAE":e.company=k(t.company))}u.value=!1}catch(n){console.error(n),u.value=!1}},N=()=>{const a=`${e.firstname};${e.email};${e.company};${e.dipperOrDiver};${e.urlOrIrl};${e.color};${e.fameOrFortune};${e.cloudOrDetails};${e.archetype};${e.tortoiseOrHare};${e.mathematicianOrArtist};${e.seed}`;e.qrCode=`${window.location.origin}/results?data=${window.btoa(unescape(encodeURIComponent(a)))}`};return{progress:q,questionnaireSteps:O,currentQuestionnaireStep:m,isLoading:u,questionnaire:l,setAnswer:I,generateUserProfile:_,submitToCRM:async()=>{const a=localStorage.getItem("marketing-preferences");let r=!1;a&&(r=JSON.parse(a).accepted),localStorage.getItem("marketing-preferences");let i=!1;await(await fetch(`${d}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,userStore:{firstname:e.firstname,company:e.company,dipperOrDiver:e.dipperOrDiver,urlOrIrl:e.urlOrIrl,color:e.color,fameOrFortune:e.fameOrFortune,cloudOrDetails:e.cloudOrDetails,archetype:e.archetype,tortoiseOrHare:e.tortoiseOrHare,mathematicianOrArtist:e.mathematicianOrArtist,seed:e.seed,qrCode:e.qrCode,acceptedCookies:i,acceptedMarketing:r}})})).json()},generateIFrameSource:(a,r=!0)=>{const i=e.firstname.split(" ")[0],s=e.firstname.split(" ").length>1?e.firstname.replace(`${i} `,""):"",n=localStorage.getItem("marketing-preferences");let p=!1;n&&(p=JSON.parse(n).accepted,console.log(p,JSON.parse(n)));const o=localStorage.getItem("cookie-preferences");let t=!1;o&&(t=JSON.parse(o).accepted);const g=y=>{const f={"en-GB":"United Kingdom","en-US":"United States","en-DE":"Germany"};return Object.keys(f).some(w=>window.location.href.toLowerCase().includes(w.toLowerCase()))?f[y.value]:"Global"};return encodeURI(`https://www2.deptagency.com/l/321011/2023-03-08/2f3z1tr?first_name=${i}&last_name=${s}&email=${e.email}&country=${g(a)}&company=${e.company}&DogStudio_1=${e.dipperOrDiver}&DogStudio_2=${e.urlOrIrl}&DogStudio_3=${e.fameOrFortune}&DogStudio_4=${e.cloudOrDetails}&DogStudio_5=${e.tortoiseOrHare}&DogStudio_6=${e.mathematicianOrArtist}&DogStudio_7=${e.qrCode||"https://preparetopioneer.com/"}&DogStudio_8=${r}&Opt_in_gdpr=${t}&Opt_in_marketing=${p}&submit`)}}}export{k as C,G as u};
